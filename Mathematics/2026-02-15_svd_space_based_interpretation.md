# SVD(Singular Value Decomposition) 정리
---

## 1. SVD 정의
임의의 선형변환
$$$
A : \mathbb{R}^n \longrightarrow \mathbb{R}^m
$$$
에 대해 SVD는 다음과 같이 분해한다.

$$$
A = U \Sigma V^T
$$$

이는 다음 문장을 수식으로 표현한 것이다.
> 입력 벡터를 **행공간과 영공간 성분으로 분해**한 뒤,  
> 영공간 성분은 제거하고,  
> 행공간 성분만을 **열공간의 방향으로 재조립**하는 분해.

$$$
A v_i = \sigma_i u_i
$$$
- $v_i$ : 입력 공간에서 의미 있는 방향  
- $\sigma_i$ : 해당 방향의 중요도 (출력 크기 영향력)  
- $u_i$ : 출력 공간에서 도착하는 방향

---

## 2. SVD가 답하려는 질문

#### 고유값 분해(EVD)의 질문
> "어떤 방향으로 넣으면 **방향이 유지된 채** 크기만 변하는가?"\

=> 즉,
$$$
Av = \lambda v
$$$
하지만 일반 행렬에서는:
- 입력 방향과 출력 방향이 다를 수 있다
- 직사각 행렬에서는 아예 비교 자체가 불가능하다

---

#### SVD의 질문
> "어떤 입력 방향이 출력 크기에 가장 크게 기여하는가?"\
> 그리고\
> "그 방향은 출력에서 어디로 가는가?"

=> 즉, **방향 보존을 포기하고**,\
입력 방향과 출력 방향을 분리해서 해석한다.

---

## 3. 입력 공간과 출력 공간?
> 고유값 분해에서 "입력 공간 = 출력 공간"이라는 말은\
> 단순히 차원이 같다는 뜻인가?
> 
> 같은 벡터공간(같은 원소 집합, 같은 내적 구조)이라는 뜻이다.

#### (1) 같은 차원 ≠ 같은 공간
이 두개는 전혀 다를 수 있다.
- $\mathbb{R}^2 → \mathbb{R}^2$\
  → 차원은 같지만 공간이 다를 수도 있다.
-  예:
  - 입력: 위치 벡터 공간
  - 출력: 속도 벡터 공간
    (차원은 둘 다 2지만 의미와 공간이 다르다)

---

#### (2) 고유값 분해가 요구하는 "같은 공간"
고유값 분해의 기본 전제는 다음과 같다:
$$$
A: V  \longrightarrow   V
$$$
즉,
- 같은 벡터공간에서
- 자기 자신으로 보내느니 변환(endomorphism)
그래서 다음이 자연스럽다:
- 입력 벡터 $v$
- 출력 벡터 $Av$
- 같은 공간에 있으니 방향 비교 가능

이 말은 곧:
> 열공간 = 행공간 = 전체공간
> (최소한 같은 공간 안에 있다)

---

#### (3) 일반 행렬에서는 무슨 일이 벌어지나
일반적인  $A∈\mathbb{R}^{m×n}$을 보자\
\
이때 구조는 다음과 같이 갈라지게 된다:
- 행공간 $C(A^T) \subset \mathbb{R}^n$ => 입력 쪽
- 열공간 $C(A) \subset  \mathbb{R}^m$ => 출력 쪽
- 영공간 $N(A) \subset  \mathbb{R}^n$

여기서 중요한 것은 다음과 같다:
> 입력이 사는 공간과\
> 출력이 사는 공간이\
> 아예 다른 부분공간일 수 있다는 것이다.

따라서, 이러한 상황에서
$$$
Av = \lambda v
$$$
를 요구하는 것은 **구조적으로 말이 안 된다.**

---

#### (4) SVD는 이 문제를 어떻게 해결하는가
SVD는 아예 이렇게 말한다:
> 입력 공간은 $\mathbb{R}^n$,\
> 출력 공간은 $\mathbb{R}^m$\
> => 서로 다른 공간으로 취급하자

그리고 각각의 "의미 있는 부분공간"을 따로 잡는다\
#### **SVD에서의 역할 분담**

- V (오른쪽 특이벡터)\
→ 입력 공간의 기준\
→ 행공간 + 영공간의 직교기저

- Σ (특이값)\
→ 행공간 성분이 열공간으로 얼마나 전달되는지

- U (왼쪽 특이벡터)\
→ 출력 공간의 기준\
→ 열공간 + 열공간의 직교여공간의 직교기저

---

#### (5) 공간 관계를 한 줄로 쓰면
$$$
\mathbb{R}^n
=
\underbrace{\mathcal{C}(A^\mathsf{T})}_{\text{row space}}
\;\oplus\;
\underbrace{\mathcal{N}(A)}_{\text{null space}}
$$$

$$$
\mathbb{R}^m
=
\underbrace{\mathcal{C}(A)}_{\text{column space}}
\;\oplus\;
\underbrace{\mathcal{C}(A)^\perp}_{\text{left null space}}
$$$

---

## 4. 벡터공간 관점에서 왜 SVD 공식이 이렇게 나오는가

#### 먼저 우리가 하고자 하는 일(목표)을 명확히 해보기
선형변환 $A: \mathbb{R}^n \longrightarrow \mathbb{R}^m$에 대해 우리가 알고 싶은건 딱 이거다:
> 입력 $x$의 어떤 성분이 살아서 출력에 영향을 주고,\
> 어떤 성분은 왜 0이 되는가?\
> 살아남는 성분은 열공간에서 어떤 방향으로 재조립되는가?

이 목표를 위해서 우리는 변환을 **공간 흐름**으로 쪼갠다

---

### 1단계: 입력 공간을 "의미 있는 둘"로 분해한다
입력 $\mathbb{R}^n$은 구조적으로 항상 이렇게 갈라진다:

- 행공간 성분: 출력에 기여한다
- 영공간 성분: $A$를 통과하면 바로 소멸

이를 좌표 수준에서 수행하려면\
행공간 + 영공간의 직교기저가 필요하다.

그 기저를 모아둔 행렬이 $V$이며,\
좌표를 뽑는 연산이 $V^T$이다.


$$$
V^T : \text{입력을 (행공간 | 영공간)좌표로 분해}
$$$

이 단계에서는 **아직 실제 변환은 일어나지 않는다.**

---

#### 왜 하필 $A^TA$의 고유벡터인가?

출력 크기는 다음으로 측정된다.
$$$
\|Ax\|^2 = x^T A^T A x
$$$

즉, 출력 크기에 대한 정보는 전부 $A^TA$에 들어 있따.

고유벡터 방향에서는\
각 방향의 기여도가 섞이지 않고 독립적으로 측정된다.

따라서 행공간을 가장 자연스럽게 분해하는 축은
$A^TA$의 고유벡터이다.

---

### 2단계: 영공간 성분은 "제거", 행공간 성분만 "세기 조절" (선택 스케일링)
다음으로 해야 할 일은 다음과 같다:
- 영공간 성분 => **완전히 제거**
- 행공간 성분 => **얼마나 강하게 출력에 반영되는지** 조절

이 요구를 만족하는 연산은
- 좌표별로 곱해주는 **대각 연산**

$$
\Sigma :
\begin{cases}
\sigma_i > 0 \quad (\text{행공간 성분}) \\
0 \quad (\text{영공간 성분})
\end{cases}
$$
즉,
$$$
\Sigma(V^Tx)
$$$
는 **"출력에 기여할 성분만 남긴 좌표"**가 된다.

---

#### 3단계: 남은 좌표를 "열공간의 실제 벡터"로 만들어야 한다
지금 남아있는 것은 숫자 좌표이기 대문에 실제 출력 벡터로 만들려면:
$$$
\mathbb{R}^m
=
\underbrace{\mathcal{C}(A)}_{\text{열공간}}
\;\oplus\;
\underbrace{\mathcal{C}(A)^\perp}_{\text{좌영공간}}
$$$

실제 출력은 항상 열공간 안에만 존재하기 때문에,\
열공간의 직교기저로 선형결합해야 한다.

그 기저가 바로 $U$다.

$$$
U: 좌표 ⟼ 열공간의\ 실제\ 벡터
$$$


```scss
입력 x
  ↓
[V^T]
  ↓
(행공간 성분 | 영공간 성분)
        ↓
      (Σ에서 0으로 소멸)
  ↓
행공간 성분만 남음
  ↓
[U]
  ↓
열공간의 실제 출력 벡터
```


